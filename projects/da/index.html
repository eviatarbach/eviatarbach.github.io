<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Data assimilation | Eviatar Bach</title> <meta name="author" content="Eviatar Bach"> <meta name="description" content=""> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://eviatarbach.github.io/projects/da/"> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Eviatar Bach</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV</a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Data assimilation</h1> <p class="post-description"></p> </header> <article> <h1 id="data-assimilation">Data assimilation</h1> <p>Data assimilation is the process of state estimation by combining model forecasts and observations.</p> <p><a class="citation" href="#bach_filtering_2024">(Bach* et al., 2024)</a></p> <h2 id="related-publications">Related publications</h2> <div class="publications"> <ol class="bibliography"></ol> <ol class="bibliography"><li> <div class="row"> <div id="vishny_high-dimensional_2024" class="col-sm-10"> <div class="title"><a href="https://doi.org/10.1029/2024MS004417" rel="external nofollow noopener" target="_blank">High-Dimensional Covariance Estimation From a Small Number of Samples</a></div> <div class="author"> David Vishny, Matthias Morzfeld, Kyle Gwirtz, <em>Eviatar Bach</em>, <a href="https://odunbar.wordpress.com/" rel="external nofollow noopener" target="_blank">Oliver R. A. Dunbar</a>, and Daniel Hodyss</div> <div class="periodical"> <em>Journal of Advances in Modeling Earth Systems</em> Aug 2024 </div> <div class="links"> <a class="abstract btn btn-sm z-depth-0" role="button">Abs</a> <a href="https://doi.org/10.1029/2024MS004417" class="btn btn-sm z-depth-0" role="button" rel="external nofollow noopener" target="_blank">HTML</a> </div> <div class="abstract hidden"> <p>We synthesize knowledge from numerical weather prediction, inverse theory, and statistics to address the problem of estimating a high-dimensional covariance matrix from a small number of samples. This problem is fundamental in statistics, machine learning/artificial intelligence, and in modern Earth science. We create several new adaptive methods for high-dimensional covariance estimation, but one method, which we call Noise-Informed Covariance Estimation (NICE), stands out because it has three important properties: (a) NICE is conceptually simple and computationally efficient; (b) NICE guarantees symmetric positive semi-definite covariance estimates; and (c) NICE is largely tuning-free. We illustrate the use of NICE on a large set of Earth science–inspired numerical examples, including cycling data assimilation, inversion of geophysical field data, and training of feed-forward neural networks with time-averaged data from a chaotic dynamical system. Our theory, heuristics and numerical tests suggest that NICE may indeed be a viable option for high-dimensional covariance estimation in many Earth science problems.</p> </div> </div> </div> </li></ol> <ol class="bibliography"><li> <div class="row"> <div id="bach_filtering_2024" class="col-sm-10"> <div class="title"><a href="https://doi.org/10.1063/5.0171827" rel="external nofollow noopener" target="_blank">Filtering Dynamical Systems Using Observations of Statistics</a></div> <div class="author"> <em>Eviatar Bach*</em>, Tim Colonius, Isabel Scherl, and <a href="http://stuart.caltech.edu/" rel="external nofollow noopener" target="_blank">Andrew Stuart</a> </div> <div class="periodical"> <em>Chaos: An Interdisciplinary Journal of Nonlinear Science</em> Mar 2024 </div> <div class="links"> <a class="abstract btn btn-sm z-depth-0" role="button">Abs</a> <a href="https://doi.org/10.1063/5.0171827" class="btn btn-sm z-depth-0" role="button" rel="external nofollow noopener" target="_blank">HTML</a> <a href="/assets/pdf/Bach2024.pdf" class="btn btn-sm z-depth-0" role="button">PDF</a> </div> <div class="abstract hidden"> <p>We consider the problem of filtering dynamical systems, possibly stochastic, using observations of statistics. Thus, the computational task is to estimate a time-evolving density ρ(v, t) given noisy observations of the true density ρ†; this contrasts with the standard filtering problem based on observations of the state v. The task is naturally formulated as an infinite-dimensional filtering problem in the space of densities ρ. However, for the purposes of tractability, we seek algorithms in state space; specifically, we introduce a mean-field state-space model, and using interacting particle system approximations to this model, we propose an ensemble method. We refer to the resulting methodology as the ensemble Fokker–Planck filter (EnFPF). Under certain restrictive assumptions, we show that the EnFPF approximates the Kalman–Bucy filter for the Fokker–Planck equation, which is the exact solution to the infinite-dimensional filtering problem. Furthermore, our numerical experiments show that the methodology is useful beyond this restrictive setting. Specifically, the experiments show that the EnFPF is able to correct ensemble statistics, to accelerate convergence to the invariant density for autonomous systems, and to accelerate convergence to time-dependent invariant densities for non-autonomous systems. We discuss possible applications of the EnFPF to climate ensembles and to turbulence modeling.</p> </div> </div> </div> </li></ol> <ol class="bibliography"><li> <div class="row"> <div id="bach_multi-model_2023" class="col-sm-10"> <div class="title"><a href="https://doi.org/10.1029/2022MS003123" rel="external nofollow noopener" target="_blank">A Multi-Model Ensemble Kalman Filter for Data Assimilation and Forecasting</a></div> <div class="author"> <em>Eviatar Bach*</em>, and <a href="https://dept.atmos.ucla.edu/tcd/people/michael-ghil" rel="external nofollow noopener" target="_blank">Michael Ghil</a> </div> <div class="periodical"> <em>Journal of Advances in Modeling Earth Systems</em> Jan 2023 </div> <div class="links"> <a class="abstract btn btn-sm z-depth-0" role="button">Abs</a> <a href="https://doi.org/10.1029/2022MS003123" class="btn btn-sm z-depth-0" role="button" rel="external nofollow noopener" target="_blank">HTML</a> </div> <div class="abstract hidden"> <p>Data assimilation (DA) aims to optimally combine model forecasts and observations that are both partial and noisy. Multi-model DA generalizes the variational or Bayesian formulation of the Kalman filter, and we prove that it is also the minimum variance linear unbiased estimator. Here, we formulate and implement a multi-model ensemble Kalman filter (MM-EnKF) based on this framework. The MM-EnKF can combine multiple model ensembles for both DA and forecasting in a flow-dependent manner; it uses adaptive model error estimation to provide matrix-valued weights for the separate models and the observations. We apply this methodology to various situations using the Lorenz96 model for illustration purposes. Our numerical experiments include multiple models with parametric error, different resolved scales, and different fidelities. The MM-EnKF results in significant error reductions compared to the best model, as well as to an unweighted multi-model ensemble, with respect to both probabilistic and deterministic error metrics.</p> </div> </div> </div> </li></ol> <ol class="bibliography"><li> <div class="row"> <div id="chattopadhyay_deep_2023" class="col-sm-10"> <div class="title"><a href="https://doi.org/10.1016/j.jcp.2023.111918" rel="external nofollow noopener" target="_blank">Deep Learning-Enhanced Ensemble-Based Data Assimilation for High-Dimensional Nonlinear Dynamical Systems</a></div> <div class="author"> <a href="https://sites.google.com/view/ashesh6810/home" rel="external nofollow noopener" target="_blank">Ashesh Chattopadhyay</a>, Ebrahim Nabizadeh, <em>Eviatar Bach</em>, and <a href="http://pedram.rice.edu/director/" rel="external nofollow noopener" target="_blank">Pedram Hassanzadeh</a> </div> <div class="periodical"> <em>Journal of Computational Physics</em> Mar 2023 </div> <div class="links"> <a class="abstract btn btn-sm z-depth-0" role="button">Abs</a> <a href="https://doi.org/10.1016/j.jcp.2023.111918" class="btn btn-sm z-depth-0" role="button" rel="external nofollow noopener" target="_blank">HTML</a> <a href="/assets/pdf/Chattopadhyay2023.pdf" class="btn btn-sm z-depth-0" role="button">PDF</a> </div> <div class="abstract hidden"> <p>Data assimilation (DA) is a key component of many forecasting models in science and engineering. DA allows one to estimate better initial conditions using an imperfect dynamical model of the system and noisy/sparse observations available from the system. Ensemble Kalman filter (EnKF) is a DA algorithm that is widely used in applications involving high-dimensional nonlinear dynamical systems. However, EnKF requires evolving large ensembles of forecasts using the dynamical model of the system. This often becomes computationally intractable, especially when the number of states of the system is very large, e.g., for weather prediction. With small ensembles, the estimated background error covariance matrix in the EnKF algorithm suffers from sampling error, leading to an erroneous estimate of the analysis state (initial condition for the next forecast cycle). In this work, we propose hybrid ensemble Kalman filter (H-EnKF), which is applied to a two-layer quasi-geostrophic turbulent flow as a test case. This framework utilizes a pre-trained deep learning-based data-driven surrogate that inexpensively generates and evolves a large data-driven ensemble of the states to accurately compute the background error covariance matrix with smaller sampling errors. The H-EnKF framework outperforms EnKF with only dynamical model or only the data-driven surrogate, and estimates a better initial condition without the need for any ad-hoc localization strategies. H-EnKF can be extended to any ensemble-based DA algorithm, e.g., particle filters, which are currently too expensive to use for high-dimensional systems.</p> </div> </div> </div> </li></ol> <ol class="bibliography"><li> <div class="row"> <div id="chattopadhyay_towards_2022" class="col-sm-10"> <div class="title"><a href="https://doi.org/10.5194/gmd-15-2221-2022" rel="external nofollow noopener" target="_blank">Towards Physics-Inspired Data-Driven Weather Forecasting: Integrating Data Assimilation with a Deep Spatial-Transformer-Based U-NET in a Case Study with ERA5</a></div> <div class="author"> <a href="https://sites.google.com/view/ashesh6810/home" rel="external nofollow noopener" target="_blank">Ashesh Chattopadhyay</a>, Mustafa Mustafa, <a href="http://pedram.rice.edu/director/" rel="external nofollow noopener" target="_blank">Pedram Hassanzadeh</a>, <em>Eviatar Bach</em>, and Karthik Kashinath</div> <div class="periodical"> <em>Geoscientific Model Development</em> Mar 2022 </div> <div class="links"> <a class="abstract btn btn-sm z-depth-0" role="button">Abs</a> <a href="https://doi.org/10.5194/gmd-15-2221-2022" class="btn btn-sm z-depth-0" role="button" rel="external nofollow noopener" target="_blank">HTML</a> </div> <div class="abstract hidden"> <p>There is growing interest in data-driven weather prediction (DDWP), e.g., using convolutional neural networks such as U-NET that are trained on data from models or reanalysis. Here, we propose three components, inspired by physics, to integrate with commonly used DDWP models in order to improve their forecast accuracy. These components are (1) a deep spatial transformer added to the latent space of U-NET to capture rotation and scaling transformation in the latent space for spatiotemporal data, (2) a data-assimilation (DA) algorithm to ingest noisy observations and improve the initial conditions for next forecasts, and (3) a multi-time-step algorithm, which combines forecasts from DDWP models with different time steps through DA, improving the accuracy of forecasts at short intervals. To show the benefit and feasibility of each component, we use geopotential height at 500 hPa (Z500) from ERA5 reanalysis and examine the short-term forecast accuracy of specific setups of the DDWP framework. Results show that the spatial-transformer-based U-NET (U-STN) clearly outperforms the U-NET, e.g., improving the forecast skill by 45 %. Using a sigma-point ensemble Kalman (SPEnKF) algorithm for DA and U-STN as the forward model, we show that stable, accurate DA cycles are achieved even with high observation noise. This DDWP+DA framework substantially benefits from large (O(1000)) ensembles that are inexpensively generated with the data-driven forward model in each DA cycle. The multi-time-step DDWP+DA framework also shows promise; for example, it reduces the average error by factors of 2–3. These results show the benefits and feasibility of these three components, which are flexible and can be used in a variety of DDWP setups. Furthermore, while here we focus on weather forecasting, the three components can be readily adopted for other parts of the Earth system, such as ocean and land, for which there is a rapid growth of data and need for forecast and assimilation.</p> </div> </div> </div> </li></ol> <ol class="bibliography"><li> <div class="row"> <div id="bach_ensemble_2021" class="col-sm-10"> <div class="title"><a href="https://doi.org/10.1175/JCLI-D-20-0624.1" rel="external nofollow noopener" target="_blank">Ensemble Oscillation Correction (EnOC): Leveraging Oscillatory Modes to Improve Forecasts of Chaotic Systems</a></div> <div class="author"> <em>Eviatar Bach*</em>, <a href="https://orcid.org/0000-0001-5905-3842" rel="external nofollow noopener" target="_blank">Safa Mote</a>, <a href="http://www.m.monsoondata.org/people/krishnamurthy.html" rel="external nofollow noopener" target="_blank">V. Krishnamurthy</a>, A. Surjalal Sharma, <a href="https://dept.atmos.ucla.edu/tcd/people/michael-ghil" rel="external nofollow noopener" target="_blank">Michael Ghil</a>, and <a href="https://www2.atmos.umd.edu/~ekalnay/" rel="external nofollow noopener" target="_blank">Eugenia Kalnay</a> </div> <div class="periodical"> <em>Journal of Climate</em> Jul 2021 </div> <div class="links"> <a class="abstract btn btn-sm z-depth-0" role="button">Abs</a> <a href="https://doi.org/10.1175/JCLI-D-20-0624.1" class="btn btn-sm z-depth-0" role="button" rel="external nofollow noopener" target="_blank">HTML</a> </div> <div class="abstract hidden"> <p>Oscillatory modes of the climate system are among its most predictable features, especially at intraseasonal time scales. These oscillations can be predicted well with data-driven methods, often with better skill than dynamical models. However, since the oscillations only represent a portion of the total variance, a method for beneficially combining oscillation forecasts with dynamical forecasts of the full system was not previously known. We introduce Ensemble Oscillation Correction (EnOC), a general method to correct oscillatory modes in ensemble forecasts from dynamical models. We compute the ensemble mean—or the ensemble probability distribution—with only the best ensemble members, as determined by their discrepancy from a data-driven forecast of the oscillatory modes. We also present an alternate method that uses ensemble data assimilation to combine the oscillation forecasts with an ensemble of dynamical forecasts of the system (EnOC-DA). The oscillatory modes are extracted with a time series analysis method called multichannel singular spectrum analysis (M-SSA), and forecast using an analog method. We test these two methods using chaotic toy models with significant oscillatory components and show that they robustly reduce error compared to the uncorrected ensemble. We discuss the applications of this method to improve prediction of monsoons as well as other parts of the climate system. We also discuss possible extensions of the method to other data-driven forecasts, including machine learning.</p> </div> </div> </div> </li></ol> <ol class="bibliography"><li> <div class="row"> <div id="penny_strongly_2019" class="col-sm-10"> <div class="title"><a href="https://doi.org/10.1029/2019MS001652" rel="external nofollow noopener" target="_blank">Strongly Coupled Data Assimilation in Multiscale Media: Experiments Using a Quasi-Geostrophic Coupled Model</a></div> <div class="author"> Stephen G. Penny, <em>Eviatar Bach</em>, Kriti Bhargava, Chu-Chun Chang, Cheng Da, Luyu Sun, and Takuma Yoshida</div> <div class="periodical"> <em>Journal of Advances in Modeling Earth Systems</em> Jun 2019 </div> <div class="links"> <a class="abstract btn btn-sm z-depth-0" role="button">Abs</a> <a href="https://doi.org/10.1029/2019MS001652" class="btn btn-sm z-depth-0" role="button" rel="external nofollow noopener" target="_blank">HTML</a> </div> <div class="abstract hidden"> <p>Strongly coupled data assimilation (SCDA) views the Earth as one unified system. This allows observations to have an instantaneous impact across boundaries such as the air-sea interface when estimating the state of each individual component. Operational prediction centers are moving toward Earth system modeling for all forecast timescales, ranging from days to months. However, there have been few studies that examine fundamental aspects of SCDA and the transition from traditional approaches that apply data assimilation only to a single component, whether forecasts were derived from a coupled model or an uncoupled forced model. The SCDA approach is examined here in detail using numerical experiments with a simple coupled atmosphere-ocean quasi-geostrophic model. The impact of coupling is explored with respect to its impact on the Lyapunov spectrum and on data assimilation system stability. Different data assimilation methods are compared within the context of SCDA, including the 3-D and 4-D Variational methods, the ensemble Kalman filter, and the hybrid gain method. The impact of observing system coverage is also investigated. We find that SCDA is generally superior to weakly coupled or uncoupled approaches. Dynamically defined background error covariance estimates are essential for SCDA to achieve an accurate coupled state estimate as the observing system becomes sparser. As a clarification of seemingly contradictory findings from previous studies, it is shown that ocean observations can adequately constrain atmospheric state estimates provided that the analysis-observing frequency is sufficiently high and the ensemble size determining the background error covariance is sufficiently large.</p> </div> </div> </div> </li></ol> </div> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Eviatar Bach. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>